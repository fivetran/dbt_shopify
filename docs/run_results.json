{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.9", "generated_at": "2024-03-20T17:27:04.145446Z", "invocation_id": "9dca7366-9d5a-4715-abda-9a287b166518", "env": {}}, "results": [{"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:55.278529Z", "completed_at": "2024-03-20T17:26:55.341657Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:55.351519Z", "completed_at": "2024-03-20T17:26:55.877600Z"}], "thread_id": "Thread-6", "execution_time": 0.7206568717956543, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.dbt_utils_unique_combination_of_columns_int_shopify__order__shipping_aggregates_order_id__source_relation.0e1a050867", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith  __dbt__cte__int_shopify__order__shipping_aggregates as (\nwith order_shipping_line as (\n\n    select\n        order_id,\n        source_relation,\n        order_shipping_line_id,\n        sum(price) as shipping_price,\n        sum(discounted_price) as discounted_shipping_price\n        \n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_shipping_line\"\n    group by 1,2,3\n\n), order_shipping_tax_line as (\n\n    select\n        order_shipping_line_id,\n        source_relation,\n        sum(price) as shipping_tax\n\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_shipping_tax_line\"\n    group by 1,2 \n\n), aggregated as (\n\n    select \n        order_shipping_line.order_id,\n        order_shipping_line.source_relation,\n        sum(order_shipping_line.shipping_price) as shipping_price,\n        sum(order_shipping_line.discounted_shipping_price) as discounted_shipping_price,\n        sum(order_shipping_tax_line.shipping_tax) as shipping_tax\n\n    from order_shipping_line\n    left join order_shipping_tax_line\n        on order_shipping_line.order_shipping_line_id = order_shipping_tax_line.order_shipping_line_id\n        and order_shipping_line.source_relation = order_shipping_tax_line.source_relation\n    group by 1,2\n)\n\nselect * \nfrom aggregated\n), validation_errors as (\n\n    select\n        order_id, source_relation\n    from __dbt__cte__int_shopify__order__shipping_aggregates\n    group by order_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:55.231539Z", "completed_at": "2024-03-20T17:26:55.290922Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:55.328290Z", "completed_at": "2024-03-20T17:26:55.945471Z"}], "thread_id": "Thread-1", "execution_time": 0.7741589546203613, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.dbt_utils_unique_combination_of_columns_int_shopify__customer_email_rollup_email__source_relation.cdcb98cbda", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        email, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_shopify\".\"int_shopify__customer_email_rollup\"\n    group by email, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:55.252294Z", "completed_at": "2024-03-20T17:26:55.338866Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:55.346994Z", "completed_at": "2024-03-20T17:26:55.959384Z"}], "thread_id": "Thread-3", "execution_time": 0.7903401851654053, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.dbt_utils_unique_combination_of_columns_int_shopify__discounts__order_aggregates_code__type__source_relation.9094049eca", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith  __dbt__cte__int_shopify__discounts__order_aggregates as (\nwith order_discount_code as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_discount_code\"\n),\n\norders as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__orders\"\n),\n\norders_aggregated as (\n\n    select \n        order_discount_code.code,\n        order_discount_code.type,\n        order_discount_code.source_relation,\n        avg(order_discount_code.amount) as avg_order_discount_amount,\n        sum(order_discount_code.amount) as total_order_discount_amount,\n        max(orders.total_line_items_price) as total_order_line_items_price, -- summing would multiply the total by the # of discount codes applied to an order\n        max(orders.shipping_cost) as total_order_shipping_cost, -- summing would multiply the total by the # of discount codes applied to an order\n        max(orders.refund_subtotal + orders.refund_total_tax) as total_order_refund_amount, -- summing would multiply the total by the # of discount codes applied to an order\n        count(distinct customer_id) as count_customers,\n        count(distinct email) as count_customer_emails,\n        count(distinct order_discount_code.order_id) as count_orders\n\n    from order_discount_code\n    join orders \n        on order_discount_code.order_id = orders.order_id \n        and order_discount_code.source_relation = orders.source_relation\n\n    group by 1,2,3\n)\n\nselect *\nfrom orders_aggregated\n), validation_errors as (\n\n    select\n        code, type, source_relation\n    from __dbt__cte__int_shopify__discounts__order_aggregates\n    group by code, type, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:55.285346Z", "completed_at": "2024-03-20T17:26:55.342255Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:55.353506Z", "completed_at": "2024-03-20T17:26:55.961134Z"}], "thread_id": "Thread-7", "execution_time": 0.7888422012329102, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.dbt_utils_unique_combination_of_columns_int_shopify__product__order_line_aggregates_product_id__source_relation.871d87e683", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith  __dbt__cte__int_shopify__product__order_line_aggregates as (\nwith order_lines as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__order_lines\"\n\n), orders as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__orders\"\n\n), product_aggregated as (\n    select \n        order_lines.product_id,\n        order_lines.source_relation,\n\n        -- moved over from shopify__products\n        sum(order_lines.quantity) as quantity_sold,\n        sum(order_lines.pre_tax_price) as subtotal_sold,\n        sum(order_lines.quantity_net_refunds) as quantity_sold_net_refunds,\n        sum(order_lines.subtotal_net_refunds) as subtotal_sold_net_refunds,\n        min(orders.created_timestamp) as first_order_timestamp,\n        max(orders.created_timestamp) as most_recent_order_timestamp,\n\n        -- new columns\n        sum(order_lines.total_discount) as product_total_discount,\n        sum(order_lines.order_line_tax) as product_total_tax,\n        avg(order_lines.quantity) as avg_quantity_per_order_line,\n        avg(order_lines.total_discount) as product_avg_discount_per_order_line,\n        avg(order_lines.order_line_tax) as product_avg_tax_per_order_line\n\n    from order_lines\n    left join orders\n        on order_lines.order_id = orders.order_id\n        and order_lines.source_relation = orders.source_relation\n    group by 1,2\n\n)\n\nselect *\nfrom product_aggregated\n), validation_errors as (\n\n    select\n        product_id, source_relation\n    from __dbt__cte__int_shopify__product__order_line_aggregates\n    group by product_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:55.291256Z", "completed_at": "2024-03-20T17:26:55.342636Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:55.355928Z", "completed_at": "2024-03-20T17:26:55.963582Z"}], "thread_id": "Thread-8", "execution_time": 0.7891931533813477, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.dbt_utils_unique_combination_of_columns_int_shopify__products_with_aggregates_product_id__source_relation.8a5ff7736c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith  __dbt__cte__int_shopify__products_with_aggregates as (\nwith products as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__product\"\n), \n\ncollection_product as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__collection_product\"\n),\n\ncollection as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__collection\"\n    where not coalesce(is_deleted, false) -- limit to only active collections\n),\n\nproduct_tag as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__product_tag\"\n),\n\nproduct_variant as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__product_variant\"\n),\n\nproduct_image as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__product_image\"\n),\n\n\ncollections_aggregated as (\n\n    select\n        collection_product.product_id,\n        collection_product.source_relation,\n        \n    string_agg(collection.title, ', ')\n\n as collections\n    from collection_product \n    join collection \n        on collection_product.collection_id = collection.collection_id\n        and collection_product.source_relation = collection.source_relation\n    group by 1,2\n),\n\ntags_aggregated as (\n\n    select \n        product_id,\n        source_relation,\n        \n    string_agg(value, ', ')\n\n as tags\n    \n    from product_tag\n    group by 1,2\n),\n\nvariants_aggregated as (\n\n    select \n        product_id,\n        source_relation,\n        count(variant_id) as count_variants\n\n    from product_variant\n    group by 1,2\n\n),\n\nimages_aggregated as (\n\n    select \n        product_id,\n        source_relation,\n        count(*) as count_images\n    from product_image\n    group by 1,2\n),\n\njoined as (\n\n    select\n        products.*,\n        collections_aggregated.collections,\n        tags_aggregated.tags,\n        variants_aggregated.count_variants,\n        coalesce(images_aggregated.count_images, 0) > 0 as has_product_image\n\n    from products\n    left join collections_aggregated\n        on products.product_id = collections_aggregated.product_id\n        and products.source_relation = collections_aggregated.source_relation\n    left join tags_aggregated\n        on products.product_id = tags_aggregated.product_id\n        and products.source_relation = tags_aggregated.source_relation\n    left join variants_aggregated\n        on products.product_id = variants_aggregated.product_id\n        and products.source_relation = variants_aggregated.source_relation\n    left join images_aggregated\n        on products.product_id = images_aggregated.product_id\n        and products.source_relation = images_aggregated.source_relation\n)\n\nselect *\nfrom joined\n), validation_errors as (\n\n    select\n        product_id, source_relation\n    from __dbt__cte__int_shopify__products_with_aggregates\n    group by product_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:55.243760Z", "completed_at": "2024-03-20T17:26:55.327986Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:55.343786Z", "completed_at": "2024-03-20T17:26:55.970320Z"}], "thread_id": "Thread-2", "execution_time": 0.8109698295593262, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.dbt_utils_unique_combination_of_columns_int_shopify__discounts__abandoned_checkouts_code__type__source_relation.36fced7795", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith  __dbt__cte__int_shopify__discounts__abandoned_checkouts as (\nwith abandoned_checkout as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__abandoned_checkout\"\n\n    -- \"deleted\" abandoned checkouts do not appear to have any data tying them to customers,\n    -- discounts, or products (and should therefore not get joined in) but let's filter them out here\n    where not coalesce(is_deleted, false)\n),\n\nabandoned_checkout_discount_code as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__abandoned_checkout_discount_code\"\n\n    -- we need the TYPE of discount (shipping, percentage, fixed_amount) to avoid fanning out of joins\n    -- so filter out records that have this\n    where coalesce(type, '') != ''\n),\n\nabandoned_checkout_shipping_line as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__abandoned_checkout_shipping_line\"\n),\n\nroll_up_shipping_line as (\n\n    select \n        checkout_id,\n        source_relation,\n        sum(price) as price\n\n    from abandoned_checkout_shipping_line\n    group by 1,2\n),\n\nabandoned_checkouts_aggregated as (\n\n    select \n        abandoned_checkout_discount_code.code,\n        abandoned_checkout_discount_code.type,\n        abandoned_checkout_discount_code.source_relation,\n        sum(abandoned_checkout_discount_code.amount) as total_abandoned_checkout_discount_amount,\n        sum(coalesce(abandoned_checkout.total_line_items_price, 0)) as total_abandoned_checkout_line_items_price,\n        sum(coalesce(roll_up_shipping_line.price, 0)) as total_abandoned_checkout_shipping_price,\n        count(distinct customer_id) as count_abandoned_checkout_customers,\n        count(distinct email) as count_abandoned_checkout_customer_emails,\n        count(distinct abandoned_checkout.checkout_id) as count_abandoned_checkouts\n\n    from abandoned_checkout_discount_code\n    left join abandoned_checkout\n        on abandoned_checkout_discount_code.checkout_id = abandoned_checkout.checkout_id\n        and abandoned_checkout_discount_code.source_relation = abandoned_checkout.source_relation\n    left join roll_up_shipping_line\n        on roll_up_shipping_line.checkout_id = abandoned_checkout_discount_code.checkout_id \n        and roll_up_shipping_line.source_relation = abandoned_checkout_discount_code.source_relation\n\n    group by 1,2,3\n)\n\nselect *\nfrom abandoned_checkouts_aggregated\n), validation_errors as (\n\n    select\n        code, type, source_relation\n    from __dbt__cte__int_shopify__discounts__abandoned_checkouts\n    group by code, type, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:55.257873Z", "completed_at": "2024-03-20T17:26:55.339702Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:55.349540Z", "completed_at": "2024-03-20T17:26:55.985322Z"}], "thread_id": "Thread-4", "execution_time": 0.818795919418335, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.dbt_utils_unique_combination_of_columns_int_shopify__emails__order_aggregates_email__source_relation.06e9d74e1a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith  __dbt__cte__int_shopify__emails__order_aggregates as (\nwith orders as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order\"\n\n), order_aggregates as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__orders__order_line_aggregates\"\n\n), transactions as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__transactions\"\n\n    where lower(status) = 'success'\n    and lower(kind) not in ('authorization', 'void')\n    and lower(gateway) != 'gift_card' -- redeeming a giftcard does not introduce new revenue\n\n), transaction_aggregates as (\n    -- this is necessary as customers can pay via multiple payment gateways\n    select \n        order_id,\n        source_relation,\n        lower(kind) as kind,\n        sum(currency_exchange_calculated_amount) as currency_exchange_calculated_amount\n\n    from transactions\n    group by 1,2,3\n\n), customer_emails as (\n-- in case any orders records don't have the customer email attached yet\n    select \n        customer_id, \n        source_relation,\n        email\n\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__customer\"\n    where email is not null\n    group by 1,2,3\n    \n), aggregated as (\n\n    select\n        lower(customer_emails.email) as email,\n        orders.source_relation,\n        min(orders.created_timestamp) as first_order_timestamp,\n        max(orders.created_timestamp) as most_recent_order_timestamp,\n        avg(transaction_aggregates.currency_exchange_calculated_amount) as avg_order_value,\n        sum(transaction_aggregates.currency_exchange_calculated_amount) as lifetime_total_spent,\n        sum(refunds.currency_exchange_calculated_amount) as lifetime_total_refunded,\n        count(distinct orders.order_id) as lifetime_count_orders,\n        avg(order_aggregates.order_total_quantity) as avg_quantity_per_order,\n        sum(order_aggregates.order_total_tax) as lifetime_total_tax,\n        avg(order_aggregates.order_total_tax) as avg_tax_per_order,\n        sum(order_aggregates.order_total_discount) as lifetime_total_discount,\n        avg(order_aggregates.order_total_discount) as avg_discount_per_order,\n        sum(order_aggregates.order_total_shipping) as lifetime_total_shipping,\n        avg(order_aggregates.order_total_shipping) as avg_shipping_per_order,\n        sum(order_aggregates.order_total_shipping_with_discounts) as lifetime_total_shipping_with_discounts,\n        avg(order_aggregates.order_total_shipping_with_discounts) as avg_shipping_with_discounts_per_order,\n        sum(order_aggregates.order_total_shipping_tax) as lifetime_total_shipping_tax,\n        avg(order_aggregates.order_total_shipping_tax) as avg_shipping_tax_per_order\n    from orders\n    join customer_emails\n        on orders.customer_id = customer_emails.customer_id\n        and orders.source_relation = customer_emails.source_relation\n    left join transaction_aggregates \n        on orders.order_id = transaction_aggregates.order_id\n        and orders.source_relation = transaction_aggregates.source_relation\n        and transaction_aggregates.kind in ('sale','capture')\n    left join transaction_aggregates as refunds\n        on orders.order_id = refunds.order_id\n        and orders.source_relation = refunds.source_relation\n        and refunds.kind = 'refund'\n    left join order_aggregates\n        on orders.order_id = order_aggregates.order_id\n        and orders.source_relation = order_aggregates.source_relation\n\n    group by 1,2\n\n)\n\nselect *\nfrom aggregated\n), validation_errors as (\n\n    select\n        email, source_relation\n    from __dbt__cte__int_shopify__emails__order_aggregates\n    group by email, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:55.267534Z", "completed_at": "2024-03-20T17:26:55.346475Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:55.360058Z", "completed_at": "2024-03-20T17:26:55.975073Z"}], "thread_id": "Thread-5", "execution_time": 0.8223578929901123, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.dbt_utils_unique_combination_of_columns_int_shopify__inventory_level__aggregates_variant_id__location_id__source_relation.13af752114", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith  __dbt__cte__shopify__orders__order_refunds as (\nwith refunds as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__refund\"\n\n), order_line_refunds as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_line_refund\"\n    \n), refund_join as (\n\n    select \n        refunds.refund_id,\n        refunds.created_at,\n        refunds.order_id,\n        refunds.user_id,\n        refunds.source_relation,\n        order_line_refunds.order_line_refund_id,\n        order_line_refunds.order_line_id,\n        order_line_refunds.restock_type,\n        order_line_refunds.quantity,\n        order_line_refunds.subtotal,\n        order_line_refunds.total_tax\n\n    from refunds\n    left join order_line_refunds\n        on refunds.refund_id = order_line_refunds.refund_id\n        and refunds.source_relation = order_line_refunds.source_relation\n\n)\n\nselect *\nfrom refund_join\n),  __dbt__cte__int_shopify__inventory_level__aggregates as (\nwith order_lines as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_line\"\n),\n\nfulfillment as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__fulfillment\"\n),\n\norders as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order\"\n    where not coalesce(is_deleted, false)\n), \n\nrefunds as (\n\n    select *\n    from __dbt__cte__shopify__orders__order_refunds\n\n), refunds_aggregated as (\n    \n    select\n        order_line_id,\n        source_relation,\n        sum(quantity) as quantity,\n        sum(coalesce(subtotal, 0)) as subtotal\n\n    from refunds\n    group by 1,2\n),\n\njoined as (\n\n    select\n        order_lines.order_line_id,\n        order_lines.variant_id,\n        order_lines.source_relation,\n        fulfillment.location_id, -- location id is stored in fulfillment rather than order\n        orders.order_id,\n        orders.customer_id,\n        fulfillment.fulfillment_id,\n        lower(orders.email) as email,\n        order_lines.pre_tax_price,\n        order_lines.quantity,\n        orders.created_timestamp as order_created_timestamp,\n        fulfillment.status as fulfillment_status, \n        refunds_aggregated.subtotal as subtotal_sold_refunds, \n        refunds_aggregated.quantity as quantity_sold_refunds\n\n    from order_lines\n    join orders\n        on order_lines.order_id = orders.order_id\n        and order_lines.source_relation = orders.source_relation\n    join fulfillment\n        on orders.order_id = fulfillment.order_id\n        and orders.source_relation = fulfillment.source_relation\n    left join refunds_aggregated\n        on refunds_aggregated.order_line_id = order_lines.order_line_id\n        and refunds_aggregated.source_relation = order_lines.source_relation\n),\n\naggregated as (\n\n    select\n        variant_id,\n        location_id,\n        source_relation,\n        sum(pre_tax_price) as subtotal_sold,\n        sum(quantity) as quantity_sold,\n        count(distinct order_id) as count_distinct_orders,\n        count(distinct customer_id) as count_distinct_customers,\n        count(distinct email) as count_distinct_customer_emails,\n        min(order_created_timestamp) as first_order_timestamp,\n        max(order_created_timestamp) as last_order_timestamp\n\n        \n        , count(distinct case when fulfillment_status = 'pending' then fulfillment_id end) as count_fulfillment_pending\n        \n        , count(distinct case when fulfillment_status = 'open' then fulfillment_id end) as count_fulfillment_open\n        \n        , count(distinct case when fulfillment_status = 'success' then fulfillment_id end) as count_fulfillment_success\n        \n        , count(distinct case when fulfillment_status = 'cancelled' then fulfillment_id end) as count_fulfillment_cancelled\n        \n        , count(distinct case when fulfillment_status = 'error' then fulfillment_id end) as count_fulfillment_error\n        \n        , count(distinct case when fulfillment_status = 'failure' then fulfillment_id end) as count_fulfillment_failure\n        \n\n        , sum(coalesce(subtotal_sold_refunds, 0)) as subtotal_sold_refunds\n        , sum(coalesce(quantity_sold_refunds, 0)) as quantity_sold_refunds\n\n    from joined\n\n    group by 1,2,3\n)\n\nselect *\nfrom aggregated\n), validation_errors as (\n\n    select\n        variant_id, location_id, source_relation\n    from __dbt__cte__int_shopify__inventory_level__aggregates\n    group by variant_id, location_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:55.951932Z", "completed_at": "2024-03-20T17:26:55.955658Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:55.956199Z", "completed_at": "2024-03-20T17:26:56.532280Z"}], "thread_id": "Thread-6", "execution_time": 0.6555788516998291, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.dbt_utils_unique_combination_of_columns_shopify__customer_emails_email__source_relation.fcf0ae8886", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        email, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__customer_emails\"\n    group by email, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:56.002120Z", "completed_at": "2024-03-20T17:26:56.014508Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:56.015060Z", "completed_at": "2024-03-20T17:26:56.567737Z"}], "thread_id": "Thread-1", "execution_time": 0.6130218505859375, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.dbt_utils_unique_combination_of_columns_shopify__customers__order_aggregates_customer_id__source_relation.5a5e85c8a9", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith  __dbt__cte__shopify__customers__order_aggregates as (\nwith orders as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order\"\n    where customer_id is not null\n\n), order_aggregates as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__orders__order_line_aggregates\"\n\n), transactions as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__transactions\"\n\n    where lower(status) = 'success'\n    and lower(kind) not in ('authorization', 'void')\n    and lower(gateway) != 'gift_card' -- redeeming a giftcard does not introduce new revenue\n\n), transaction_aggregates as (\n    -- this is necessary as customers can pay via multiple payment gateways\n    select \n        order_id,\n        source_relation,\n        lower(kind) as kind,\n        sum(currency_exchange_calculated_amount) as currency_exchange_calculated_amount\n\n    from transactions\n    group by 1,2,3\n\n), customer_tags as (\n\n    select *\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__customer_tag\"\n\n), customer_tags_aggregated as (\n\n    select \n        customer_id,\n        source_relation,\n        \n    string_agg(distinct cast(value as TEXT), ', ')\n\n as customer_tags\n\n    from customer_tags\n    group by 1,2\n\n), aggregated as (\n\n    select\n        orders.customer_id,\n        orders.source_relation,\n        customer_tags_aggregated.customer_tags,\n        min(orders.created_timestamp) as first_order_timestamp,\n        max(orders.created_timestamp) as most_recent_order_timestamp,\n        avg(transaction_aggregates.currency_exchange_calculated_amount) as avg_order_value,\n        sum(transaction_aggregates.currency_exchange_calculated_amount) as lifetime_total_spent,\n        sum(refunds.currency_exchange_calculated_amount) as lifetime_total_refunded,\n        count(distinct orders.order_id) as lifetime_count_orders,\n        avg(order_aggregates.order_total_quantity) as avg_quantity_per_order,\n        sum(order_aggregates.order_total_tax) as lifetime_total_tax,\n        avg(order_aggregates.order_total_tax) as avg_tax_per_order,\n        sum(order_aggregates.order_total_discount) as lifetime_total_discount,\n        avg(order_aggregates.order_total_discount) as avg_discount_per_order,\n        sum(order_aggregates.order_total_shipping) as lifetime_total_shipping,\n        avg(order_aggregates.order_total_shipping) as avg_shipping_per_order,\n        sum(order_aggregates.order_total_shipping_with_discounts) as lifetime_total_shipping_with_discounts,\n        avg(order_aggregates.order_total_shipping_with_discounts) as avg_shipping_with_discounts_per_order,\n        sum(order_aggregates.order_total_shipping_tax) as lifetime_total_shipping_tax,\n        avg(order_aggregates.order_total_shipping_tax) as avg_shipping_tax_per_order\n\n    from orders\n    left join transaction_aggregates \n        on orders.order_id = transaction_aggregates.order_id\n        and orders.source_relation = transaction_aggregates.source_relation\n        and transaction_aggregates.kind in ('sale','capture')\n    left join transaction_aggregates as refunds\n        on orders.order_id = refunds.order_id\n        and orders.source_relation = refunds.source_relation\n        and refunds.kind = 'refund'\n    left join order_aggregates\n        on orders.order_id = order_aggregates.order_id\n        and orders.source_relation = order_aggregates.source_relation\n    left join customer_tags_aggregated\n        on orders.customer_id = customer_tags_aggregated.customer_id\n        and orders.source_relation = customer_tags_aggregated.source_relation\n    \n    group by 1,2,3\n)\n\nselect *\nfrom aggregated\n), validation_errors as (\n\n    select\n        customer_id, source_relation\n    from __dbt__cte__shopify__customers__order_aggregates\n    group by customer_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:56.033015Z", "completed_at": "2024-03-20T17:26:56.042737Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:56.051895Z", "completed_at": "2024-03-20T17:26:56.648622Z"}], "thread_id": "Thread-8", "execution_time": 0.6755950450897217, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.dbt_utils_unique_combination_of_columns_shopify__discounts_discount_code_id__source_relation.ddf4da9206", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        discount_code_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__discounts\"\n    group by discount_code_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:56.100107Z", "completed_at": "2024-03-20T17:26:56.107633Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:56.108683Z", "completed_at": "2024-03-20T17:26:56.652804Z"}], "thread_id": "Thread-4", "execution_time": 0.6136212348937988, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.dbt_utils_unique_combination_of_columns_shopify__orders__order_line_aggregates_order_id__source_relation.09d921d473", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        order_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__orders__order_line_aggregates\"\n    group by order_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:56.029480Z", "completed_at": "2024-03-20T17:26:56.039234Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:56.039822Z", "completed_at": "2024-03-20T17:26:56.657060Z"}], "thread_id": "Thread-7", "execution_time": 0.6881542205810547, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.dbt_utils_unique_combination_of_columns_shopify__discounts_code__source_relation.6983c8ac7f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        code, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__discounts\"\n    group by code, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:56.025909Z", "completed_at": "2024-03-20T17:26:56.042056Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:56.044726Z", "completed_at": "2024-03-20T17:26:56.664667Z"}], "thread_id": "Thread-3", "execution_time": 0.6890192031860352, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.dbt_utils_unique_combination_of_columns_shopify__customers_customer_id__source_relation.88d3656469", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        customer_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__customers\"\n    group by customer_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:56.047428Z", "completed_at": "2024-03-20T17:26:56.093391Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:56.096212Z", "completed_at": "2024-03-20T17:26:56.662057Z"}], "thread_id": "Thread-2", "execution_time": 0.6708569526672363, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.dbt_utils_unique_combination_of_columns_shopify__inventory_levels_inventory_item_id__location_id__source_relation.1498734606", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        inventory_item_id, location_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__inventory_levels\"\n    group by inventory_item_id, location_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:56.103831Z", "completed_at": "2024-03-20T17:26:56.108388Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:56.111154Z", "completed_at": "2024-03-20T17:26:56.663398Z"}], "thread_id": "Thread-5", "execution_time": 0.6149239540100098, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.dbt_utils_unique_combination_of_columns_shopify__products_product_id__source_relation.f00b2fb95a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        product_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__products\"\n    group by product_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:56.620009Z", "completed_at": "2024-03-20T17:26:56.623745Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:56.624276Z", "completed_at": "2024-03-20T17:26:57.170601Z"}], "thread_id": "Thread-1", "execution_time": 0.6170558929443359, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.not_null_shopify__customer_email_cohorts_customer_cohort_id.ccd3e5bc48", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_cohort_id\nfrom \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__customer_email_cohorts\"\nwhere customer_cohort_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:56.608731Z", "completed_at": "2024-03-20T17:26:56.614790Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:56.615423Z", "completed_at": "2024-03-20T17:26:57.172024Z"}], "thread_id": "Thread-6", "execution_time": 0.6290531158447266, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.not_null_shopify__customer_cohorts_customer_cohort_id.88e9c30925", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_cohort_id\nfrom \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__customer_cohorts\"\nwhere customer_cohort_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:56.702110Z", "completed_at": "2024-03-20T17:26:56.705751Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:56.706274Z", "completed_at": "2024-03-20T17:26:57.310443Z"}], "thread_id": "Thread-8", "execution_time": 0.6838719844818115, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.not_null_shopify__daily_shop_shop_id.8ac464697f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect shop_id\nfrom \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__daily_shop\"\nwhere shop_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:56.725196Z", "completed_at": "2024-03-20T17:26:56.739540Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:56.743617Z", "completed_at": "2024-03-20T17:26:57.388250Z"}], "thread_id": "Thread-7", "execution_time": 0.7343530654907227, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.not_null_shopify__inventory_levels_inventory_item_id.272596fe56", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect inventory_item_id\nfrom \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__inventory_levels\"\nwhere inventory_item_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:56.736466Z", "completed_at": "2024-03-20T17:26:56.746604Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:56.751873Z", "completed_at": "2024-03-20T17:26:57.396991Z"}], "thread_id": "Thread-5", "execution_time": 0.7348952293395996, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.not_null_shopify__orders_orders_unique_key.456504d2f9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect orders_unique_key\nfrom \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__orders\"\nwhere orders_unique_key is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:56.729679Z", "completed_at": "2024-03-20T17:26:56.741060Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:56.749757Z", "completed_at": "2024-03-20T17:26:57.389059Z"}], "thread_id": "Thread-3", "execution_time": 0.7406778335571289, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.not_null_shopify__inventory_levels_location_id.80391b9ca0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect location_id\nfrom \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__inventory_levels\"\nwhere location_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:56.733394Z", "completed_at": "2024-03-20T17:26:56.740693Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:56.747736Z", "completed_at": "2024-03-20T17:26:57.396080Z"}], "thread_id": "Thread-2", "execution_time": 0.7403950691223145, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.not_null_shopify__order_lines_order_lines_unique_key.54d23b5bf2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_lines_unique_key\nfrom \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__order_lines\"\nwhere order_lines_unique_key is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:56.720940Z", "completed_at": "2024-03-20T17:26:56.733095Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:56.741364Z", "completed_at": "2024-03-20T17:26:57.390747Z"}], "thread_id": "Thread-4", "execution_time": 0.744189977645874, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.not_null_shopify__discounts_discount_code_id.4ae7c46f81", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect discount_code_id\nfrom \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__discounts\"\nwhere discount_code_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:57.240003Z", "completed_at": "2024-03-20T17:26:57.249459Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:57.250569Z", "completed_at": "2024-03-20T17:26:57.807557Z"}], "thread_id": "Thread-1", "execution_time": 0.6263828277587891, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.not_null_shopify__transactions_transactions_unique_id.4769714a1f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transactions_unique_id\nfrom \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__transactions\"\nwhere transactions_unique_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:57.244529Z", "completed_at": "2024-03-20T17:26:57.249780Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:57.252673Z", "completed_at": "2024-03-20T17:26:57.833386Z"}], "thread_id": "Thread-6", "execution_time": 0.6507301330566406, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.unique_shopify__customer_cohorts_customer_cohort_id.c5e4855c7a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_cohort_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__customer_cohorts\"\nwhere customer_cohort_id is not null\ngroup by customer_cohort_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:57.391033Z", "completed_at": "2024-03-20T17:26:57.397899Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:57.398539Z", "completed_at": "2024-03-20T17:26:57.897843Z"}], "thread_id": "Thread-8", "execution_time": 0.568432092666626, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.unique_shopify__customer_email_cohorts_customer_cohort_id.74d42a8182", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_cohort_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__customer_email_cohorts\"\nwhere customer_cohort_id is not null\ngroup by customer_cohort_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:57.454985Z", "completed_at": "2024-03-20T17:26:57.463094Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:57.466362Z", "completed_at": "2024-03-20T17:26:58.021994Z"}], "thread_id": "Thread-7", "execution_time": 0.6420266628265381, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.unique_shopify__order_lines_order_lines_unique_key.b3f13d075e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_lines_unique_key as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__order_lines\"\nwhere order_lines_unique_key is not null\ngroup by order_lines_unique_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:57.478418Z", "completed_at": "2024-03-20T17:26:57.496152Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:57.501926Z", "completed_at": "2024-03-20T17:26:58.087368Z"}], "thread_id": "Thread-2", "execution_time": 0.6737828254699707, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.accepted_values_stg_shopify__fulfillment_event_status__attempted_delivery__delivered__failure__in_transit__out_for_delivery__ready_for_pickup__picked_up__label_printed__label_purchased__confirmed.c0ab202601", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__fulfillment_event\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'attempted_delivery','delivered','failure','in_transit','out_for_delivery','ready_for_pickup','picked_up','label_printed','label_purchased','confirmed'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:57.474545Z", "completed_at": "2024-03-20T17:26:57.492753Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:57.493274Z", "completed_at": "2024-03-20T17:26:58.094740Z"}], "thread_id": "Thread-3", "execution_time": 0.6843020915985107, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.unique_shopify__transactions_transactions_unique_id.7e0fab5981", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    transactions_unique_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__transactions\"\nwhere transactions_unique_id is not null\ngroup by transactions_unique_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:57.486862Z", "completed_at": "2024-03-20T17:26:57.495609Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:57.499848Z", "completed_at": "2024-03-20T17:26:58.092488Z"}], "thread_id": "Thread-4", "execution_time": 0.6841521263122559, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.accepted_values_stg_shopify__fulfillment_status__pending__open__success__cancelled__error__failure.7c48600b70", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__fulfillment\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'pending','open','success','cancelled','error','failure'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:57.471045Z", "completed_at": "2024-03-20T17:26:57.495298Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:57.496755Z", "completed_at": "2024-03-20T17:26:58.098795Z"}], "thread_id": "Thread-5", "execution_time": 0.6888227462768555, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify.unique_shopify__orders_orders_unique_key.d7c1623d51", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    orders_unique_key as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"shopify_integration_tests_56_shopify\".\"shopify__orders\"\nwhere orders_unique_key is not null\ngroup by orders_unique_key\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:57.866958Z", "completed_at": "2024-03-20T17:26:57.872221Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:57.872791Z", "completed_at": "2024-03-20T17:26:58.396977Z"}], "thread_id": "Thread-1", "execution_time": 0.5894200801849365, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.accepted_values_stg_shopify__price_rule_target_type__line_item__shipping_line.921059c008", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        target_type as value_field,\n        count(*) as n_records\n\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__price_rule\"\n    group by target_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'line_item','shipping_line'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:57.892378Z", "completed_at": "2024-03-20T17:26:57.898717Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:57.899259Z", "completed_at": "2024-03-20T17:26:58.463385Z"}], "thread_id": "Thread-6", "execution_time": 0.6484289169311523, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.accepted_values_stg_shopify__price_rule_value_type__percentage__fixed_amount.65eceed909", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        value_type as value_field,\n        count(*) as n_records\n\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__price_rule\"\n    group by value_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'percentage','fixed_amount'\n)\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:57.957547Z", "completed_at": "2024-03-20T17:26:57.962557Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:57.963169Z", "completed_at": "2024-03-20T17:26:58.546808Z"}], "thread_id": "Thread-8", "execution_time": 0.6429979801177979, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__abandoned_checkout_checkout_id__source_relation.46f03b4b58", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        checkout_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__abandoned_checkout\"\n    group by checkout_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:58.099601Z", "completed_at": "2024-03-20T17:26:58.104903Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:58.105506Z", "completed_at": "2024-03-20T17:26:58.655143Z"}], "thread_id": "Thread-7", "execution_time": 0.6219379901885986, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__abandoned_checkout_discount_code_checkout_id__code__source_relation.7c343c0e84", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        checkout_id, code, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__abandoned_checkout_discount_code\"\n    group by checkout_id, code, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:58.145177Z", "completed_at": "2024-03-20T17:26:58.149262Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:58.149810Z", "completed_at": "2024-03-20T17:26:58.711315Z"}], "thread_id": "Thread-2", "execution_time": 0.6162891387939453, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__abandoned_checkout_shipping_line_checkout_id__index__source_relation.adf831caac", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        checkout_id, index, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__abandoned_checkout_shipping_line\"\n    group by checkout_id, index, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:58.164104Z", "completed_at": "2024-03-20T17:26:58.212093Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:58.212647Z", "completed_at": "2024-03-20T17:26:58.776014Z"}], "thread_id": "Thread-4", "execution_time": 0.6676990985870361, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__collection_product_collection_id__product_id__source_relation.2a7693423e", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        collection_id, product_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__collection_product\"\n    group by collection_id, product_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:58.159829Z", "completed_at": "2024-03-20T17:26:58.209301Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:58.209881Z", "completed_at": "2024-03-20T17:26:58.776839Z"}], "thread_id": "Thread-3", "execution_time": 0.6694741249084473, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__collection_collection_id__source_relation.1df832a878", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        collection_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__collection\"\n    group by collection_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:58.205970Z", "completed_at": "2024-03-20T17:26:58.214653Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:58.215186Z", "completed_at": "2024-03-20T17:26:58.778471Z"}], "thread_id": "Thread-5", "execution_time": 0.6683270931243896, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__customer_customer_id__source_relation.1b2185db25", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        customer_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__customer\"\n    group by customer_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:58.458588Z", "completed_at": "2024-03-20T17:26:58.464481Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:58.465122Z", "completed_at": "2024-03-20T17:26:59.020565Z"}], "thread_id": "Thread-1", "execution_time": 0.6224589347839355, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__customer_tag_customer_id__index__source_relation.a145b36d0f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        customer_id, index, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__customer_tag\"\n    group by customer_id, index, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:58.542141Z", "completed_at": "2024-03-20T17:26:58.547588Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:58.548242Z", "completed_at": "2024-03-20T17:26:59.060098Z"}], "thread_id": "Thread-6", "execution_time": 0.5732860565185547, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__discount_code_discount_code_id__source_relation.cdfb802172", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        discount_code_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__discount_code\"\n    group by discount_code_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:58.601723Z", "completed_at": "2024-03-20T17:26:58.606688Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:58.607294Z", "completed_at": "2024-03-20T17:26:59.191043Z"}], "thread_id": "Thread-8", "execution_time": 0.6569702625274658, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__fulfillment_event_fulfillment_event_id__source_relation.bbccfe999a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        fulfillment_event_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__fulfillment_event\"\n    group by fulfillment_event_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:58.721622Z", "completed_at": "2024-03-20T17:26:58.725707Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:58.726236Z", "completed_at": "2024-03-20T17:26:59.256853Z"}], "thread_id": "Thread-7", "execution_time": 0.60837721824646, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__fulfillment_fulfillment_id__source_relation.680798d67a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        fulfillment_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__fulfillment\"\n    group by fulfillment_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:58.762706Z", "completed_at": "2024-03-20T17:26:58.767074Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:58.767763Z", "completed_at": "2024-03-20T17:26:59.338903Z"}], "thread_id": "Thread-2", "execution_time": 0.6371099948883057, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__inventory_item_inventory_item_id__source_relation.efb946be84", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        inventory_item_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__inventory_item\"\n    group by inventory_item_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:58.832720Z", "completed_at": "2024-03-20T17:26:58.844142Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:58.844791Z", "completed_at": "2024-03-20T17:26:59.395387Z"}], "thread_id": "Thread-4", "execution_time": 0.6197912693023682, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__inventory_level_inventory_item_id__location_id__source_relation.30e02799e7", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        inventory_item_id, location_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__inventory_level\"\n    group by inventory_item_id, location_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:58.839154Z", "completed_at": "2024-03-20T17:26:58.847508Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:58.850557Z", "completed_at": "2024-03-20T17:26:59.396849Z"}], "thread_id": "Thread-5", "execution_time": 0.6195023059844971, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__metafield_metafield_id__source_relation.f74f7735ca", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        metafield_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__metafield\"\n    group by metafield_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:58.836238Z", "completed_at": "2024-03-20T17:26:58.847206Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:58.848395Z", "completed_at": "2024-03-20T17:26:59.398403Z"}], "thread_id": "Thread-3", "execution_time": 0.6317269802093506, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__location_location_id__source_relation.d3455164b9", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        location_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__location\"\n    group by location_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:59.081793Z", "completed_at": "2024-03-20T17:26:59.085910Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:59.086464Z", "completed_at": "2024-03-20T17:26:59.625519Z"}], "thread_id": "Thread-1", "execution_time": 0.5993578433990479, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__order_adjustment_order_adjustment_id__source_relation.00b7d10cb0", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        order_adjustment_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_adjustment\"\n    group by order_adjustment_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:59.116630Z", "completed_at": "2024-03-20T17:26:59.120316Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:59.120841Z", "completed_at": "2024-03-20T17:26:59.686804Z"}], "thread_id": "Thread-6", "execution_time": 0.6350851058959961, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__order_discount_code_order_id__code__source_relation.0b164cd5b1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        order_id, code, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_discount_code\"\n    group by order_id, code, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:59.259930Z", "completed_at": "2024-03-20T17:26:59.263827Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:59.264346Z", "completed_at": "2024-03-20T17:26:59.817243Z"}], "thread_id": "Thread-8", "execution_time": 0.6141281127929688, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__order_line_order_line_id__source_relation.c2797e7a9c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        order_line_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_line\"\n    group by order_line_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:59.331358Z", "completed_at": "2024-03-20T17:26:59.337650Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:59.339724Z", "completed_at": "2024-03-20T17:26:59.883194Z"}], "thread_id": "Thread-7", "execution_time": 0.6093001365661621, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__order_line_refund_order_line_refund_id__source_relation.1877420c29", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        order_line_refund_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_line_refund\"\n    group by order_line_refund_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:59.400997Z", "completed_at": "2024-03-20T17:26:59.405032Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:59.405556Z", "completed_at": "2024-03-20T17:26:59.938281Z"}], "thread_id": "Thread-2", "execution_time": 0.5956821441650391, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__order_note_attribute_order_id__name__source_relation.b214a3d1c0", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        order_id, name, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_note_attribute\"\n    group by order_id, name, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:59.465127Z", "completed_at": "2024-03-20T17:26:59.474498Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:59.475796Z", "completed_at": "2024-03-20T17:27:00.056917Z"}], "thread_id": "Thread-3", "execution_time": 0.6376042366027832, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__order_shipping_tax_line_order_shipping_line_id__index__source_relation.f13c5fef8d", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        order_shipping_line_id, index, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_shipping_tax_line\"\n    group by order_shipping_line_id, index, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:59.458965Z", "completed_at": "2024-03-20T17:26:59.468601Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:59.469153Z", "completed_at": "2024-03-20T17:27:00.071242Z"}], "thread_id": "Thread-5", "execution_time": 0.6641302108764648, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__order_shipping_line_order_shipping_line_id__source_relation.6d1c3ae933", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        order_shipping_line_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_shipping_line\"\n    group by order_shipping_line_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:59.454345Z", "completed_at": "2024-03-20T17:26:59.471258Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:59.471803Z", "completed_at": "2024-03-20T17:27:00.065911Z"}], "thread_id": "Thread-4", "execution_time": 0.6650691032409668, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__order_order_id__source_relation.81d10381c1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        order_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order\"\n    group by order_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:59.682346Z", "completed_at": "2024-03-20T17:26:59.687559Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:59.688119Z", "completed_at": "2024-03-20T17:27:00.255214Z"}], "thread_id": "Thread-1", "execution_time": 0.6389131546020508, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__order_tag_order_id__index__source_relation.9a2443bd07", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        order_id, index, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_tag\"\n    group by order_id, index, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:59.753761Z", "completed_at": "2024-03-20T17:26:59.757980Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:59.758503Z", "completed_at": "2024-03-20T17:27:00.303108Z"}], "thread_id": "Thread-6", "execution_time": 0.5982251167297363, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__order_url_tag_order_id__key__source_relation.568d75c0cf", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        order_id, key, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_url_tag\"\n    group by order_id, key, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:59.875546Z", "completed_at": "2024-03-20T17:26:59.879512Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:59.880045Z", "completed_at": "2024-03-20T17:27:00.418278Z"}], "thread_id": "Thread-8", "execution_time": 0.6003971099853516, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__price_rule_price_rule_id__source_relation.56ce313bee", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        price_rule_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__price_rule\"\n    group by price_rule_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:59.941794Z", "completed_at": "2024-03-20T17:26:59.945946Z"}, {"name": "execute", "started_at": "2024-03-20T17:26:59.946479Z", "completed_at": "2024-03-20T17:27:00.474019Z"}], "thread_id": "Thread-7", "execution_time": 0.5920472145080566, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__product_image_product_image_id__source_relation.9614191ead", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        product_image_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__product_image\"\n    group by product_image_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:26:59.997991Z", "completed_at": "2024-03-20T17:27:00.003429Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:00.004519Z", "completed_at": "2024-03-20T17:27:00.512104Z"}], "thread_id": "Thread-2", "execution_time": 0.5616438388824463, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__product_product_id__source_relation.48b32ab6a2", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        product_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__product\"\n    group by product_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:00.103991Z", "completed_at": "2024-03-20T17:27:00.107737Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:00.108272Z", "completed_at": "2024-03-20T17:27:00.655478Z"}], "thread_id": "Thread-3", "execution_time": 0.6140580177307129, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__product_tag_product_id__index__source_relation.995253e0cc", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        product_id, index, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__product_tag\"\n    group by product_id, index, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:00.122520Z", "completed_at": "2024-03-20T17:27:00.183343Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:00.190786Z", "completed_at": "2024-03-20T17:27:00.716035Z"}], "thread_id": "Thread-5", "execution_time": 0.6510436534881592, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__product_variant_variant_id__source_relation.7506695ec0", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        variant_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__product_variant\"\n    group by variant_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:00.167830Z", "completed_at": "2024-03-20T17:27:00.183056Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:00.188635Z", "completed_at": "2024-03-20T17:27:00.716843Z"}], "thread_id": "Thread-4", "execution_time": 0.6511759757995605, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__refund_refund_id__source_relation.cd4dbc2b35", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        refund_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__refund\"\n    group by refund_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:00.322519Z", "completed_at": "2024-03-20T17:27:00.327021Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:00.327543Z", "completed_at": "2024-03-20T17:27:00.837101Z"}], "thread_id": "Thread-1", "execution_time": 0.5723106861114502, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__shop_shop_id__source_relation.29a0875415", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        shop_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__shop\"\n    group by shop_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:00.353242Z", "completed_at": "2024-03-20T17:27:00.356923Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:00.357451Z", "completed_at": "2024-03-20T17:27:00.893382Z"}], "thread_id": "Thread-6", "execution_time": 0.6053080558776855, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__tax_line_order_line_id__index__source_relation.f01b294800", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        order_line_id, index, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__tax_line\"\n    group by order_line_id, index, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:00.477068Z", "completed_at": "2024-03-20T17:27:00.480931Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:00.481457Z", "completed_at": "2024-03-20T17:27:01.010265Z"}], "thread_id": "Thread-8", "execution_time": 0.5903041362762451, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__tender_transaction_transaction_id__source_relation.96e8ff578b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        transaction_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__tender_transaction\"\n    group by transaction_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:00.535186Z", "completed_at": "2024-03-20T17:27:00.539094Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:00.539635Z", "completed_at": "2024-03-20T17:27:01.072899Z"}], "thread_id": "Thread-7", "execution_time": 0.592047929763794, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.dbt_utils_unique_combination_of_columns_stg_shopify__transaction_transaction_id__source_relation.d55a33652a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        transaction_id, source_relation\n    from \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__transaction\"\n    group by transaction_id, source_relation\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:00.560883Z", "completed_at": "2024-03-20T17:27:00.564676Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:00.565194Z", "completed_at": "2024-03-20T17:27:01.077370Z"}], "thread_id": "Thread-2", "execution_time": 0.5728499889373779, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__abandoned_checkout_checkout_id.7904acc8db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect checkout_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__abandoned_checkout\"\nwhere checkout_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:00.719971Z", "completed_at": "2024-03-20T17:27:00.723907Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:00.724463Z", "completed_at": "2024-03-20T17:27:01.267286Z"}], "thread_id": "Thread-3", "execution_time": 0.6258699893951416, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__abandoned_checkout_discount_code_checkout_id.c00e9d48a7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect checkout_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__abandoned_checkout_discount_code\"\nwhere checkout_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:00.776034Z", "completed_at": "2024-03-20T17:27:00.783742Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:00.784283Z", "completed_at": "2024-03-20T17:27:01.376390Z"}], "thread_id": "Thread-5", "execution_time": 0.6609058380126953, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__collection_collection_id.96b2719af2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect collection_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__collection\"\nwhere collection_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:00.779505Z", "completed_at": "2024-03-20T17:27:00.786369Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:00.786888Z", "completed_at": "2024-03-20T17:27:01.423367Z"}], "thread_id": "Thread-4", "execution_time": 0.718743085861206, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__collection_product_collection_id.8bf72f774a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect collection_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__collection_product\"\nwhere collection_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:00.959890Z", "completed_at": "2024-03-20T17:27:00.963984Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:00.964515Z", "completed_at": "2024-03-20T17:27:01.492862Z"}], "thread_id": "Thread-6", "execution_time": 0.5912048816680908, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__customer_tag_customer_id.c532ce5351", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__customer_tag\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:00.896066Z", "completed_at": "2024-03-20T17:27:00.899698Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:00.900220Z", "completed_at": "2024-03-20T17:27:01.491756Z"}], "thread_id": "Thread-1", "execution_time": 0.6554248332977295, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__collection_product_product_id.1e720211b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__collection_product\"\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:01.068624Z", "completed_at": "2024-03-20T17:27:01.073581Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:01.074170Z", "completed_at": "2024-03-20T17:27:01.674466Z"}], "thread_id": "Thread-8", "execution_time": 0.662092924118042, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__customer_tag_index.1db05a64dd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect index\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__customer_tag\"\nwhere index is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:01.128448Z", "completed_at": "2024-03-20T17:27:01.133742Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:01.135205Z", "completed_at": "2024-03-20T17:27:01.732694Z"}], "thread_id": "Thread-7", "execution_time": 0.6625137329101562, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__discount_code_discount_code_id.a5590b867e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect discount_code_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__discount_code\"\nwhere discount_code_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:01.138456Z", "completed_at": "2024-03-20T17:27:01.142833Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:01.143399Z", "completed_at": "2024-03-20T17:27:01.738733Z"}], "thread_id": "Thread-2", "execution_time": 0.6543591022491455, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__fulfillment_fulfillment_id.ef5030632e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect fulfillment_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__fulfillment\"\nwhere fulfillment_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:01.347008Z", "completed_at": "2024-03-20T17:27:01.351459Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:01.352007Z", "completed_at": "2024-03-20T17:27:01.912214Z"}], "thread_id": "Thread-3", "execution_time": 0.6242587566375732, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__inventory_item_inventory_item_id.ebb8e84fbe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect inventory_item_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__inventory_item\"\nwhere inventory_item_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:01.437544Z", "completed_at": "2024-03-20T17:27:01.441072Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:01.441580Z", "completed_at": "2024-03-20T17:27:01.968467Z"}], "thread_id": "Thread-5", "execution_time": 0.5900931358337402, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__inventory_level_inventory_item_id.fccf494b8e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect inventory_item_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__inventory_level\"\nwhere inventory_item_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:01.495839Z", "completed_at": "2024-03-20T17:27:01.499468Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:01.500007Z", "completed_at": "2024-03-20T17:27:02.035034Z"}], "thread_id": "Thread-4", "execution_time": 0.5969119071960449, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__inventory_level_location_id.92e79be57f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect location_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__inventory_level\"\nwhere location_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:01.558504Z", "completed_at": "2024-03-20T17:27:01.562131Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:01.562657Z", "completed_at": "2024-03-20T17:27:02.091371Z"}], "thread_id": "Thread-1", "execution_time": 0.5924711227416992, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__metafield_metafield_id.456551b3c6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect metafield_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__metafield\"\nwhere metafield_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:01.553787Z", "completed_at": "2024-03-20T17:27:01.564791Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:01.565384Z", "completed_at": "2024-03-20T17:27:02.098055Z"}], "thread_id": "Thread-6", "execution_time": 0.6068809032440186, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__location_location_id.ee4166d1bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect location_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__location\"\nwhere location_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:01.733464Z", "completed_at": "2024-03-20T17:27:01.739519Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:01.740085Z", "completed_at": "2024-03-20T17:27:02.280053Z"}], "thread_id": "Thread-8", "execution_time": 0.6038990020751953, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__order_discount_code_code.067f3e6d0f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect code\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_discount_code\"\nwhere code is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:01.793602Z", "completed_at": "2024-03-20T17:27:01.804646Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:01.805280Z", "completed_at": "2024-03-20T17:27:02.311463Z"}], "thread_id": "Thread-7", "execution_time": 0.5781271457672119, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__order_discount_code_order_id.ca7b6ffa4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_discount_code\"\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:01.798184Z", "completed_at": "2024-03-20T17:27:01.801555Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:01.802062Z", "completed_at": "2024-03-20T17:27:02.332968Z"}], "thread_id": "Thread-2", "execution_time": 0.5954833030700684, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__order_note_attribute_name.1c77264446", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect name\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_note_attribute\"\nwhere name is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:01.972468Z", "completed_at": "2024-03-20T17:27:01.976135Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:01.976654Z", "completed_at": "2024-03-20T17:27:02.491487Z"}], "thread_id": "Thread-3", "execution_time": 0.5586349964141846, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__order_note_attribute_order_id.d710018375", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_note_attribute\"\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:02.028867Z", "completed_at": "2024-03-20T17:27:02.036406Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:02.037341Z", "completed_at": "2024-03-20T17:27:02.594031Z"}], "thread_id": "Thread-5", "execution_time": 0.6335399150848389, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__order_shipping_line_order_shipping_line_id.37ad762613", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_shipping_line_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_shipping_line\"\nwhere order_shipping_line_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:02.093928Z", "completed_at": "2024-03-20T17:27:02.098707Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:02.099203Z", "completed_at": "2024-03-20T17:27:02.661200Z"}], "thread_id": "Thread-4", "execution_time": 0.6212399005889893, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__order_shipping_tax_line_index.fd09a295cd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect index\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_shipping_tax_line\"\nwhere index is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:02.162841Z", "completed_at": "2024-03-20T17:27:02.166552Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:02.167137Z", "completed_at": "2024-03-20T17:27:02.712289Z"}], "thread_id": "Thread-6", "execution_time": 0.6080939769744873, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__order_tag_index.c8a0f2d6a2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect index\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_tag\"\nwhere index is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:02.151916Z", "completed_at": "2024-03-20T17:27:02.155690Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:02.156205Z", "completed_at": "2024-03-20T17:27:02.713998Z"}], "thread_id": "Thread-1", "execution_time": 0.6248021125793457, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__order_shipping_tax_line_order_shipping_line_id.0fcfb55295", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_shipping_line_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_shipping_tax_line\"\nwhere order_shipping_line_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:02.337413Z", "completed_at": "2024-03-20T17:27:02.341036Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:02.341564Z", "completed_at": "2024-03-20T17:27:02.893487Z"}], "thread_id": "Thread-8", "execution_time": 0.6105940341949463, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__order_tag_order_id.cfe1531ec6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_tag\"\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:02.372258Z", "completed_at": "2024-03-20T17:27:02.376654Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:02.377196Z", "completed_at": "2024-03-20T17:27:02.895295Z"}], "thread_id": "Thread-7", "execution_time": 0.5831112861633301, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__order_url_tag_key.4644eec325", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect key\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_url_tag\"\nwhere key is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:02.394832Z", "completed_at": "2024-03-20T17:27:02.398422Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:02.398943Z", "completed_at": "2024-03-20T17:27:02.953546Z"}], "thread_id": "Thread-2", "execution_time": 0.6153120994567871, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__order_url_tag_order_id.84a8f408d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__order_url_tag\"\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:02.532590Z", "completed_at": "2024-03-20T17:27:02.536757Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:02.537262Z", "completed_at": "2024-03-20T17:27:03.071188Z"}], "thread_id": "Thread-3", "execution_time": 0.6038260459899902, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__price_rule_price_rule_id.a7160b00e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect price_rule_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__price_rule\"\nwhere price_rule_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:02.664283Z", "completed_at": "2024-03-20T17:27:02.667953Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:02.668473Z", "completed_at": "2024-03-20T17:27:03.199907Z"}], "thread_id": "Thread-5", "execution_time": 0.6114730834960938, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__product_image_product_image_id.911df72b9c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_image_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__product_image\"\nwhere product_image_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:02.716971Z", "completed_at": "2024-03-20T17:27:02.721546Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:02.722092Z", "completed_at": "2024-03-20T17:27:03.252079Z"}], "thread_id": "Thread-4", "execution_time": 0.6176791191101074, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__product_tag_index.fb66bd9019", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect index\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__product_tag\"\nwhere index is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:02.772059Z", "completed_at": "2024-03-20T17:27:02.776426Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:02.777597Z", "completed_at": "2024-03-20T17:27:03.336944Z"}], "thread_id": "Thread-6", "execution_time": 0.6263971328735352, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__product_tag_product_id.2b27a85ed3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__product_tag\"\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:02.781002Z", "completed_at": "2024-03-20T17:27:02.785227Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:02.785722Z", "completed_at": "2024-03-20T17:27:03.335604Z"}], "thread_id": "Thread-1", "execution_time": 0.6188259124755859, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__shop_shop_id.42e70e2fbe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect shop_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__shop\"\nwhere shop_id is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-03-20T17:27:02.949289Z", "completed_at": "2024-03-20T17:27:02.955374Z"}, {"name": "execute", "started_at": "2024-03-20T17:27:02.956017Z", "completed_at": "2024-03-20T17:27:03.560676Z"}], "thread_id": "Thread-8", "execution_time": 0.6742911338806152, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": null, "failures": 0, "unique_id": "test.shopify_source.not_null_stg_shopify__tender_transaction_transaction_id.61935430b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect transaction_id\nfrom \"postgres\".\"shopify_integration_tests_56_stg_shopify\".\"stg_shopify__tender_transaction\"\nwhere transaction_id is null\n\n\n", "relation_name": null}], "elapsed_time": 10.933818101882935, "args": {"introspect": true, "favor_state": false, "use_colors": true, "version_check": true, "log_format": "default", "profiles_dir": "/Users/catherinefritz/.dbt", "cache_selected_only": false, "partial_parse_file_diff": true, "populate_cache": true, "quiet": false, "select": [], "log_file_max_bytes": 10485760, "exclude": [], "defer": false, "project_dir": "/Users/catherinefritz/Documents/dbt_packages/shopify/dbt_shopify/integration_tests", "log_path": "/Users/catherinefritz/Documents/dbt_packages/shopify/dbt_shopify/integration_tests/logs", "macro_debugging": false, "which": "test", "log_level": "info", "printer_width": 80, "warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug", "write_json": true, "strict_mode": false, "use_colors_file": true, "print": true, "send_anonymous_usage_stats": true, "indirect_selection": "eager", "vars": {}, "enable_legacy_logger": false, "show_resource_report": false, "log_format_file": "debug", "invocation_command": "dbt test", "partial_parse": true, "static_parser": true}}